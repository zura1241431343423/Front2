<div class="auth-container">
 
  <div class="auth-toggle" *ngIf="!isForgotPasswordMode && !isResetPasswordMode">
    <button
      type="button"
      class="toggle-button"
      [class.active]="isRegisterMode"
      (click)="switchToRegister()">
      Register
    </button>
    <button
      type="button"
      class="toggle-button"
      [class.active]="!isRegisterMode"
      (click)="switchToLogin()">
      Login
    </button>
  </div>

  <form (ngSubmit)="onSubmit(authForm)" #authForm="ngForm">
    <h2 class="form-title">
      {{ isResetPasswordMode ? 'Reset Your Password' : 
         (isForgotPasswordMode ? 'Reset Password' : 
         (isRegisterMode ? 'Create Account' : 'Log In')) }}
    </h2>

    
    <div *ngIf="isResetPasswordMode" class="form-fields-group">
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email"
               [value]="resetEmail" readonly
               class="readonly-email">
      </div>

 

      
    </div>

   
    <div *ngIf="!isResetPasswordMode">
      
      <div *ngIf="isRegisterMode && !isForgotPasswordMode" class="form-fields-group">
        <div class="form-group">
          <label for="name">Name</label>
          <input type="text" id="name" name="name"
                 placeholder="Enter your first name"
                 required ngModel #name="ngModel">
          <div class="error-message" *ngIf="name.invalid && (name.dirty || name.touched || authForm.submitted)">
            <div *ngIf="name.errors?.['required']">Name is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="lastname">Last Name</label>
          <input type="text" id="lastname" name="lastname"
                 placeholder="Enter your last name"
                 required ngModel #lastname="ngModel">
          <div class="error-message" *ngIf="lastname.invalid && (lastname.dirty || lastname.touched || authForm.submitted)">
            <div *ngIf="lastname.errors?.['required']">Last name is required</div>
          </div>
        </div>
      </div>

    
      <div class="form-fields-group">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email"
                 placeholder="Enter your email"
                 [required]="!isResetPasswordMode" 
                 email ngModel #email="ngModel"
                 [readonly]="isResetPasswordMode">
          <div class="error-message" *ngIf="email.invalid && (email.dirty || email.touched || authForm.submitted)">
            <div *ngIf="email.errors?.['required']">Email is required</div>
            <div *ngIf="email.errors?.['email']">Please enter a valid email</div>
          </div>
          <p *ngIf="isForgotPasswordMode" class="info-text">
            Enter your email address and we'll send you a link to reset your password.
          </p>
        </div>

        
        <div class="form-group password-group" *ngIf="!isForgotPasswordMode">
          <label for="password">Password</label>
          <div class="password-input-container">
            <input [type]="showPassword ? 'text' : 'password'" id="password" name="password"
                   placeholder="Enter your password"
                   [required]="!isForgotPasswordMode"  
                   minlength="8" ngModel #password="ngModel">
            <button type="button" class="toggle-password" (click)="togglePasswordVisibility()" tabindex="-1">
              <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="m19.8 22.6l-4.2-4.15q-.875.275-1.762.413T12 19q-3.775 0-6.725-2.087T1 11.5q.525-1.325 1.325-2.463T4.15 7L1.4 4.2l1.4-1.4l18.4 18.4zM12 16q.275 0 .513-.025t.512-.1l-5.4-5.4q-.075.275-.1.513T7.5 11.5q0 1.875 1.313 3.188T12 16m7.3.45l-3.175-3.15q.175-.425.275-.862t.1-.938q0-1.875-1.312-3.187T12 7q-.5 0-.937.1t-.863.3L7.65 4.85q1.025-.425 2.1-.637T12 4q3.775 0 6.725 2.088T23 11.5q-.575 1.475-1.513 2.738T19.3 16.45m-4.625-4.6l-3-3q.7-.125 1.288.113t1.012.687t.613 1.038t.087 1.162"/></svg>
              <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 16q1.875 0 3.188-1.312T16.5 11.5t-1.312-3.187T12 7T8.813 8.313T7.5 11.5t1.313 3.188T12 16m0-1.8q-1.125 0-1.912-.788T9.3 11.5t.788-1.912T12 8.8t1.913.788t.787 1.912t-.787 1.913T12 14.2m0 4.8q-3.65 0-6.65-2.037T1 11.5q1.35-3.425 4.35-5.462T12 4t6.65 2.038T23 11.5q-1.35 3.425-4.35 5.463T12 19"/></svg>
            </button>
          </div>
          <div class="error-message" *ngIf="password.invalid && (password.dirty || password.touched || authForm.submitted)">
            <div *ngIf="password.errors?.['required']">Password is required</div>
            <div *ngIf="password.errors?.['minlength']">Password must be at least 8 characters</div>
          </div>
        </div>
      </div>

      
      <div *ngIf="isRegisterMode && !isForgotPasswordMode" class="form-fields-group">
        <div class="form-group">
          <label for="address">Address</label>
          <textarea id="address" name="address" rows="3"
                    placeholder="Enter your address" ngModel #address="ngModel"></textarea>
        </div>
      </div>
    </div>

    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>

    <div class="success-message" *ngIf="successMessage">
      {{ successMessage }}
    </div>

    <button type="submit" class="submit-button"
    [disabled]="(isResetPasswordMode ? (!authForm.controls['newPassword']?.valid || !authForm.controls['confirmPassword']?.valid) : 
               (isForgotPasswordMode ? !authForm.controls['email']?.valid : !authForm.valid)) || isLoading">
{{ isLoading ? 'Processing...' : 
 (isResetPasswordMode ? 'Reset Password' : 
 (isForgotPasswordMode ? 'Send Reset Link' : 
 (isRegisterMode ? 'Register' : 'Login'))) }}
</button>

    
    <div class="form-footer">
      <button type="button" class="link-button"
              *ngIf="!isRegisterMode && !isForgotPasswordMode && !isResetPasswordMode"
              (click)="switchToForgotPassword()">
        Forgot Password?
      </button>
      <button type="button" class="link-button cancel-button"
              *ngIf="isForgotPasswordMode || isResetPasswordMode"
              (click)="cancelForgotPassword()">
        {{ isResetPasswordMode ? 'Back to Login' : 'Cancel' }}
      </button>
    </div>
  </form>
</div>